<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scenic Stay Booking</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" rel="stylesheet">
    <style>
        /* ... (previous styles remain unchanged) ... */

        .calendar-day {
            position: relative;
            height: 80px;
            overflow: hidden;  /* Add this to contain the colored bars */
        }

        .occupancy-bar {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            transition: height 0.3s;
        }

        .occupancy-number {
            position: absolute;
            bottom: 5px;
            right: 5px;
            font-size: 12px;
            color: white;
            background-color: rgba(0,0,0,0.5);
            padding: 2px 4px;
            border-radius: 2px;
            z-index: 1;  /* Ensure the number is above the colored bars */
        }

        .booking-item {
            padding: 10px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .booking-color {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <!-- ... (body content remains unchanged) ... -->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pikaday/1.8.0/pikaday.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/pikaday/1.8.0/css/pikaday.min.css">
    <script>
        let bookings = [];
        const bookingForm = document.getElementById('bookingForm');
        const bookingList = document.getElementById('bookingList');
        const calendarContainer = document.getElementById('calendarContainer');
        const errorMessage = document.getElementById('errorMessage');

        // Function to generate a random color
        function getRandomColor() {
            const letters = '0123456789ABCDEF';
            let color = '#';
            for (let i = 0; i < 6; i++) {
                color += letters[Math.floor(Math.random() * 16)];
            }
            return color;
        }

        // ... (other functions and event listeners remain unchanged) ...

        function addBooking(name, startDate, endDate) {
            const color = getRandomColor();
            bookings.push({name, startDate, endDate, color});
        }

        function updateDisplay() {
            bookingList.innerHTML = bookings.map(booking => `
                <div class="booking-item">
                    <div style="display: flex; align-items: center;">
                        <div class="booking-color" style="background-color: ${booking.color};"></div>
                        <span class="booking-name">${booking.name}</span>
                    </div>
                    <span class="booking-dates">${booking.startDate.toDateString()} to ${booking.endDate.toDateString()}</span>
                </div>
            `).join('');

            renderCalendar();
        }

        function renderCalendar() {
            // ... (previous renderCalendar code) ...

            // Modify the calendar day rendering part:
            const currentDate = new Date(month.getFullYear(), month.getMonth(), dayCount);
            const dayBookings = getBookingsForDay(currentDate);
            const occupancy = dayBookings.length;
            let occupancyBars = '';
            dayBookings.forEach((booking, index) => {
                const height = 100 / occupancy;
                occupancyBars += `<div class="occupancy-bar" style="height: ${height}%; background-color: ${booking.color}; bottom: ${index * height}%;"></div>`;
            });

            calendarHTML += `
                <td class="calendar-day">
                    <div class="day-number">${dayCount}</div>
                    ${occupancyBars}
                    ${occupancy > 0 ? `<div class="occupancy-number">${occupancy}</div>` : ''}
                </td>
            `;

            // ... (rest of the renderCalendar function) ...
        }

        function getBookingsForDay(date) {
            return bookings.filter(booking => 
                date >= booking.startDate && date <= booking.endDate
            );
        }

        // ... (rest of the script remains unchanged) ...
    </script>
</body>
</html>